
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Anatomy of a nodebot powered aquarium part 2: the hardware</title>
    <meta name="description" content="">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="../favicon.ico">

    <link rel="stylesheet" type="text/css" href="../assets/css/screen.css?v=d03024f356">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic%7COpen+Sans:700,400">

    <link rel="canonical" href="http://138.68.15.179/anatomy-of-a-nodebot-powered-aquarium-part-2-the-hardware/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="http://138.68.15.179/anatomy-of-a-nodebot-powered-aquarium-part-2-the-hardware/amp/">
    
    <meta property="og:site_name" content="Theoretical Ideations">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Anatomy of a nodebot powered aquarium part 2: the hardware">
    <meta property="og:description" content="Now that I've discussed the general concepts and the problem statement in part 1, it's time to talk hardware details. There are three primary hardware components: the Raspberry Pi, the lights (described in part 1), and an interface board to connect the two. The Raspberry Pi, pictured below, is a">
    <meta property="og:url" content="http://138.68.15.179/anatomy-of-a-nodebot-powered-aquarium-part-2-the-hardware/">
    <meta property="article:published_time" content="2013-09-12T10:02:56.000Z">
    <meta property="article:modified_time" content="2014-06-30T06:23:34.000Z">
    <meta property="article:tag" content="aquarium-control">
    <meta property="article:tag" content="node.js">
    <meta property="article:tag" content="nodebots">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Anatomy of a nodebot powered aquarium part 2: the hardware">
    <meta name="twitter:description" content="Now that I've discussed the general concepts and the problem statement in part 1, it's time to talk hardware details. There are three primary hardware components: the Raspberry Pi, the lights (described in part 1), and an interface board to connect the two. The Raspberry Pi, pictured below, is a">
    <meta name="twitter:url" content="http://138.68.15.179/anatomy-of-a-nodebot-powered-aquarium-part-2-the-hardware/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Bryan Hughes">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="aquarium-control, node.js, nodebots">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Theoretical Ideations",
        "logo": "http://138.68.15.179/ghost/img/ghosticon.jpg"
    },
    "author": {
        "@type": "Person",
        "name": "Bryan Hughes",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/b2c8ee28e90a3e97ba056d444114bb06?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "http://138.68.15.179/author/bryan-hughes/",
        "sameAs": [
            "https://github.com/bryan-m-hughes"
        ],
        "description": "I&#x27;m a web framework dev at Rdio and love JavaScript! I&#x27;m also an amateur photographer, avid gamer, film enthusiast, wine lover, and very lucky husband!"
    },
    "headline": "Anatomy of a nodebot powered aquarium part 2: the hardware",
    "url": "http://138.68.15.179/anatomy-of-a-nodebot-powered-aquarium-part-2-the-hardware/",
    "datePublished": "2013-09-12T10:02:56.000Z",
    "dateModified": "2014-06-30T06:23:34.000Z",
    "keywords": "aquarium-control, node.js, nodebots",
    "description": "Now that I&#x27;ve discussed the general concepts and the problem statement in part 1, it&#x27;s time to talk hardware details. There are three primary hardware components: the Raspberry Pi, the lights (described in part 1), and an interface board to connect the two. The Raspberry Pi, pictured below, is a",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://138.68.15.179"
    }
}
    </script>

    <meta name="generator" content="Ghost 0.11">
    <link rel="alternate" type="application/rss+xml" title="Theoretical Ideations" href="http://138.68.15.179/rss/">
</head>
<body class="post-template tag-aquarium-control tag-node-js tag-nodebots nav-closed">

    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="index.html#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
            <li class="nav-home" role="presentation"><a href="http://138.68.15.179/">Home</a></li>
    </ul>
        <a class="subscribe-button icon-feed" href="http://138.68.15.179/rss/">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">

        


<header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        
            <a class="menu-button icon-menu" href="index.html#"><span class="word">Menu</span></a>
    </nav>
</header>

<main class="content" role="main">
    <article class="post tag-aquarium-control tag-node-js tag-nodebots">

        <header class="post-header">
            <h1 class="post-title">Anatomy of a nodebot powered aquarium part 2: the hardware</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2013-09-12">12 September 2013</time>  on <a href="../tag/aquarium-control/">aquarium-control</a>, <a href="../tag/node-js/">node.js</a>, <a href="../tag/nodebots/">nodebots</a>
            </section>
        </header>

        <section class="post-content">
            <p>Now that I've discussed the general concepts and the problem statement in <a title="Anatomy of a nodebot powered aquarium part 1: overview" href="http://theoreticalideations.com/2013/09/05/anatomy-of-a-nodebot-powered-aquarium-part-1-overview/">part 1</a>, it's time to talk hardware details. There are three primary hardware components: the Raspberry Pi, the lights (described in part 1), and an interface board to connect the two.</p>

<p>The <a href="http://www.raspberrypi.org/">Raspberry Pi</a>, pictured below, is a credit-card sized computer featuring an ARM SoC (System on a Chip) from Broadcom, HDMI, USB, Ethernet, analog and digital audio out, and direct access to the built-in SoC peripherals via headers.</p>

<p><a href="http://en.wikipedia.org/wiki/Raspberry_Pi"><img alt="http://upload.wikimedia.org/wikipedia/commons/3/3d/RaspberryPi.jpg" src="http://upload.wikimedia.org/wikipedia/commons/3/3d/RaspberryPi.jpg"></a> Raspberry Pi</p>

<p>Important for this project is the GPIO (General Purpose Input Output) pins on the main header in the upper left corner of the board. I'm using two of these pins to control the two sets of lights. Setting them low (0V) turns on the lights and setting them high (3.3V) turns them off.</p>

<p><a href="http://elinux.org/Rpi_Low-level_peripherals"><img alt="Peripheral Header" src="http://elinux.org/images/2/2a/GPIOs.png" width="254" height="581"></a></p>

<p>The logic is inverted because the first two GPIO pins have pull-up resistors built into them. A pull-up resistor is a resistor, typically in the tens of kohms, that connects a logic pin to vdd (3.3V). Pull-up and pull-down (connected to ground) resistors are used to stabilize logic pins, such as GPIO. When a pin is configured as an input, or is first powering up, the voltage tends to float around all over the place. By connecting a fairly large resistor to either vdd or gnd, it will prevent the pin from floating and lock it to whatever voltage the resistor is connected to. Since it has a relatively large resistance, when the pin is switched to an output and the chip more or less connects it directly to vdd/gnd, the resistor acts like it isn't there. Using inverted logic is the more sensible route here because the Raspberry Pi uses pull-up resistors, meaning things are going to be logic high by default, which we want to be off.</p>

<p>With the signals, we still need a way to convert 3.3V to 0V and 0V to 12V. In addition, the Raspberry Pi can only output up to 16mA, which is way way way below the 1.2A needed to power the daytime lights. This is where the interface board comes into play.</p>

<p>The interface board is a custom board that I designed using <a href="http://www.kicad-pcb.org/display/KICAD/KiCad+EDA+Software+Suite">KiCAD</a> and had manufactured by <a href="http://oshpark.com/">OSH Park</a>, both of which totally rock! This part of the project took by far the most time and money. I ended up going through three revisions of the board before I got something that worked properly. I did a blog post on the <a title="Node.js + raspberry pi + aquarium = awesome!" href="https://theoreticalideations.com/2013/05/10/node-js-raspberry-pi-aquarium-awesome/">first version</a> of the board back in May, for reference. Admittedly this is mostly due to me being rusty at board design, considering that I haven't done any board design of any sort since college. The results are working very well though, so no complaints!</p>

<p>The board works by first running the Raspberry Pi signals through an inverter. This serves two purposes: it inverts the signals back to non-inverted logic, and it also buffers the signals, helping to protect the Raspberry Pi. The output of the inverter is connected to the base of a load driver, which is basically just a BJT (Bipolar Junction Transistor) that turns on and off. Connected to the source is a SPDT (Single Pole Double Throw) non-latching relay with a 5V switching voltage regulator powered by the 12V aquarium power supply on the other end. When the input to the load driver is 0V, the transistor is pretty much an open circuit, meaning that the relay sees 5V on either side of its coil contacts and is thus in it's "off" position. When the input to the load driver is 3.3V (or so), the transistor is pretty much a short circuit, so the relay sees 5V on one side of the coil and 0V on the other and is thus in it's "on" position. Connected to the switch is the 12V power supply from the aquarium on one end and the lights on the other.</p>

<p>There are a few other pieces added to the interface board. A 3-way switch is connected that can a) disconnect power from the interface board, thus disabling the entire system, b) connect power to the interface board such that it is operating as described above, or c) bypasses the interface board and directly connects the daytime lights to the power source (useful for maintenance). There are also some diagnostic LEDs that show which light is currently on (if any) and whether or not power is connected to the interface board. There are also a few fuses, protection diodes, and filter capacitors spread around the board.</p>

<p>Here is the schematic for the board:</p>

<p><a href="../static/2013/09/Schematic.png"><img alt="Interface Board Schematic" src="../static/2013/09/Schematic.png" width="2357" height="1052"></a></p>

<p>Here is the layout for the board:</p>

<p><a href="../static/2013/09/Layout.png"><img alt="Interface Board Layout" src="../static/2013/09/Layout.png" width="2088" height="1534"></a></p>

<p>And finally, here are some pictures of the board in all of its purple glory:</p>

<p><a href="../static/2013/09/Interface-Board-Top.jpg"><img alt="Interface Board Top" src="../static/2013/09/Interface-Board-Top.jpg" width="1800" height="1414"></a></p>

<p><a href="../static/2013/09/Interface-Board-Bottom.jpg"><img alt="Interface Board Bottom" src="../static/2013/09/Interface-Board-Bottom.jpg" width="1800" height="1538"></a></p>
        </section>

        <footer class="post-footer">


            <figure class="author-image">
                <a class="img" href="../author/bryan-hughes/" style="background-image: url(https://www.gravatar.com/avatar/b2c8ee28e90a3e97ba056d444114bb06?s&amp;)"><span class="hidden">Bryan Hughes's Picture</span></a>
            </figure>

            <section class="author">
                <h4><a href="../author/bryan-hughes/">Bryan Hughes</a></h4>

                    <p>I'm a web framework dev at Rdio and love JavaScript! I'm also an amateur photographer, avid gamer, film enthusiast, wine lover, and very lucky husband!</p>
                <div class="author-meta">
                    <span class="author-location icon-location">San Francisco, CA</span>
                    <span class="author-link icon-link"><a href="https://github.com/bryan-m-hughes">https://github.com/bryan-m-hughes</a></span>
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/intent/tweet?text=Anatomy%20of%20a%20nodebot%20powered%20aquarium%20part%202%3A%20the%20hardware&amp;url=http://138.68.15.179/anatomy-of-a-nodebot-powered-aquarium-part-2-the-hardware/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://138.68.15.179/anatomy-of-a-nodebot-powered-aquarium-part-2-the-hardware/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=http://138.68.15.179/anatomy-of-a-nodebot-powered-aquarium-part-2-the-hardware/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>


        </footer>

    </article>
</main>

<aside class="read-next">
    <a class="read-next-story no-cover" href="../anatomy-of-a-nodebot-powered-aquarium-part-3-the-software/">
        <section class="post">
            <h2>Anatomy of a nodebot powered aquarium part 3: the software</h2>
            <p>Rounding out my in depth discussion of my aquarium nodebot from part 1 and part 2, I'm going to…</p>
        </section>
    </a>
    <a class="read-next-story prev no-cover" href="../anatomy-of-a-nodebot-powered-aquarium-part-1-overview/">
        <section class="post">
            <h2>Anatomy of a nodebot powered aquarium part 1: overview</h2>
            <p>Now that I have successfully deployed my aquarium controlling nodebot, I want to talk about how it works. The…</p>
        </section>
    </a>
</aside>



        <footer class="site-footer clearfix">
            <section class="copyright"><a href="http://138.68.15.179">Theoretical Ideations</a> © 2018</section>
            <section class="poweredby">Proudly published with <a href="https://ghost.org">Ghost</a></section>
        </footer>

    </div>

    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
    
    <script type="text/javascript" src="../assets/js/jquery.fitvids.js?v=d03024f356"></script>
    <script type="text/javascript" src="../assets/js/index.js?v=d03024f356"></script>

</body>
